# TRƯỜNG ĐẠI HỌC KHOA HỌC TỰ NHIÊN, ĐHQG-HCM
## ĐỀ THI KẾT THÚC HỌC PHẦN - CLC
## Học kỳ 3 – Năm học 2024-2025

| **Tên học phần:** | Phương pháp lập trình hướng đối tượng |
| :--- | :--- |
| **Mã HP:** | CSC10003 |
| **Thời gian:** | 100 phút |
| **Ngày thi:** | 18/8/2025 |
| **Ghi chú:** | Sinh viên [x] được phép / [ ] không được phép sử dụng tài liệu trong phòng thi |

**Lưu ý:**
- Chỉ được phép sử dụng một tờ giấy A4 tài liệu (viết tay hoặc in trên cả hai mặt).
- Khuyến khích sinh viên trả lời rõ ràng bằng tiếng Anh.

---
* **Link đề:** [https://www.facebook.com/groups/tailieuhcmus/posts/1749038895729099](https://www.facebook.com/groups/tailieuhcmus/posts/1749038895729099)
* **Đáp án tham khảo:** [https://docs.google.com/document/d/1gv0PvIIT98FGYQJCIEK51NeGMScG672vWPgpcqpMztQ/edit?usp=sharing](https://docs.google.com/document/d/1gv0PvIIT98FGYQJCIEK51NeGMScG672vWPgpcqpMztQ/edit?usp=sharing)

---

**Câu 1 (1 điểm):** Nêu sự khác biệt giữa thành phần dữ liệu tĩnh (static data members) và thành phần dữ liệu không tĩnh (non-static data members) trong C++.

**Câu 2 (2 điểm):** Giả sử tất cả các thư viện cần thiết đã được khai báo, đọc đoạn mã C++ dưới đây và trả lời các câu hỏi sau:

<table width="100%">
<tr>
<td width="50%" valign="top">
<pre lang="cpp">
01 class Shape {
02 protected:
03   string _name;
04 public:
05   Shape():_name("") {
06     cout << "Shape default constructor\n";
07   }
08   Shape(string name):_name(name) {
09     cout << "Shape parameter constructor\n";
10   }
11   virtual ~Shape() {
12     cout << "Shape destructor\n";
13   }
14   virtual double area() = 0;
15   virtual void display() {
16     cout << _name << endl;
17   }
18 };
19 class Point {
20   int _x, _y;
21 public:
22   Point(int x = 0, int y = 0):_x(x), _y(y) {
23     cout << "Point constructor\n";
24   }
25   Point(const Point& p) {
26     _x = p._x; _y = p._y;
27     cout << "Point copy constructor\n";
28   }
29   ~Point() { cout << "Point destructor\n";}
30 };
</pre>
</td>
<td width="50%" valign="top">
<pre lang="cpp">
31 class Rectangle : public Shape {
32   Point _topLeft;
33   int _width, _height;
34 public:
35   Rectangle(const Point& p, int w, int h)
36       : Shape("Rectangle"), _topLeft(p),
37       _width(w), _height(h) {
38     cout << "Rectangle constructor\n";
39   }
40   Rectangle(const Rectangle& p) {
41     cout << "Rectangle copy constructor\n";
42     _name = p._name; _width = p._width;
43     _height = p._height; _topLeft = p._topLeft;
44   }
45   double area() override {
46     return _width * _height;
47   }
48   void display() override {
49     cout << _name << ": " << area() << endl;
50   }
51   ~Rectangle() {
52     cout << "Rectangle destructor\n";
53   }
54 };
55 void main() {
56   Rectangle rec1(Point(1, 2), 4, 5);
57   Shape* s = new Rectangle(rec1);
58   s->display();
59   delete s;
60 }
</pre>
</td>
</tr>
</table>

a) Những gì được in ra màn hình khi biên dịch và thực thi đoạn mã trên? (1 điểm) <br>
b) Với mỗi dòng kết quả in ra, hãy đưa ra lời giải thích. (1 điểm)

**Câu 3 (3 điểm):** Cài đặt một lớp C++ tên là `Computer` để mô hình hóa các thông số kỹ thuật của máy tính và hỗ trợ đầy đủ các toán tử so sánh cũng như nhập/xuất luồng (input/output streaming). Cụ thể, lớp này tuân theo các đặc tả dưới đây:

**Các thuộc tính (Attributes):**
- `brand` (string): Tên thương hiệu của máy tính.
- `ram` (int): Đơn vị là GB.
- `cpu` (float): Đơn vị là GHz.

**Các phương thức (Methods):**
- `getPerformanceScore()` trả về `ram * cpu`.

**Nạp chồng toán tử (Operator Overloads):**
- So sánh: `==`, `!=`, `<`, `<=`, `>`, `>=` dựa trên `getPerformanceScore()`.
- Luồng `>>`: để nhập `brand`, `ram`, `cpu`.
- Luồng `<<`: để xuất ra định dạng "Brand: `<brand>`, RAM: `<ram>`GB, CPU: `<cpu>`GHz".

**Câu 4 (4 điểm):** Đọc đoạn văn sau và làm theo hướng dẫn. 

**A. Các struct & class tiện ích**

1. Bạn được cung cấp một lớp `Integer` đã được cài đặt như sau:

<table>
<tr>
    <th width="40%">Định nghĩa lớp (Class definition)</th>
    <th width="60%">Ví dụ sử dụng (Sample usage)</th>
</tr>
<tr>
<td>
<pre lang="cpp">
class Integer {
public:
  static bool isPrime(int number);
};
</pre>
</td>
<td>
<pre lang="cpp">
int number = 19;
if (Integer::isPrime(number)) {
  cout << number << " is a prime number";
}
</pre>
</td>
</tr>
</table>

2. Giả định bạn không muốn sử dụng ngoại lệ (exception) để xử lý lỗi (giả sử bạn làm việc cho Google: `https://google.github.io/styleguide/cppguide.html#Exceptions`).

<table>
<tr>
    <th width="40%">Định nghĩa Struct (Struct definition)</th>
    <th width="60%">Các hàm hỗ trợ (Helper functions)</th>
</tr>
<tr>
<td>
<pre lang="cpp">
template &lt;typename T&gt;
struct Expected {
public:
  bool success;
  string message;
  T data;
};
</pre>
</td>
<td>
<pre lang="cpp">
template&lt;typename T&gt;
Expected&lt;T&gt; succeed(T value) {
  return Expected&lt;T&gt; { true, "", value };
}
template&lt;typename T&gt;
Expected&lt;T&gt; fail(string message) {
  return Expected&lt;T&gt; { false, message, T{} };
}
</pre>
</td>
</tr>
</table>

Sau đó, chúng ta có thể sử dụng nó trong trường hợp thông thường như sau:

```cpp
Expected<int> divide(int a, int b) {
    if (b == 0) return fail<int>("Divided by zero exception");
    int result = a / b;
    return succeed<int>(result);
}

int main() {
    Expected<int> result = divide(10, 2);
    if (result.success) cout << result.data;
    else cout << result.message;
    return 0;
}
```

**B. Ngữ cảnh:** Viết một chương trình nhận một số nguyên tố từ console trong khoảng [1, 100]. Đầu vào phải được kiểm tra bằng cách sử dụng các Data Validators để đảm bảo chính xác. Chương trình chính được viết như sau:

```cpp
#include <iostream>
#include <string>
#include <format>
using namespace std;

// TODO01: Sửa lớp này để lưu trữ các validator
class IntegerRequestUseCase {
public:
    Expected<int> nextPrime(string prompt);
};

// TODO02: Bạn phải sửa hàm này
Expected<int> IntegerRequestUseCase::nextPrime(string prompt)
{
    cout << prompt;
    string buffer;
    getline(cin, buffer);
    int value = stoi(buffer);
    return succeed<int>(value);
}

int main()
{
    int min = 1, max = 100;
    IntegerRequestUseCase useCase;
    // TODO03: Thêm các validator vào đây
    string prompt = format(
        "Please enter a prime number within the range of [{}, {}]: ",
        min, max
    );
    auto result = useCase.nextPrime(prompt);
    if (result.success) {
        cout << "You entered a prime: " << result.data << endl;
    }
    else {
        cout << "Error: " << result.message << endl;
    }
    return 0;
}
```

**C. Yêu cầu:** Thiết kế giải pháp sử dụng các nguyên lý OOP sao cho các module kiểm tra dữ liệu (Validators) dễ dàng mở rộng và chỉnh sửa. Mỗi validator phải được cài đặt như một lớp riêng biệt tuân theo một giao diện chung (common interface). Trong yêu cầu cơ bản, danh sách các validator như sau:

| Tên (Name) | Mô tả (Description) |
| :--- | :--- |
| ValidIntegerFormatValidator | Chuỗi đầu vào phải có định dạng số nguyên hợp lệ. |
| IsPrimeValidator | Số phải là số nguyên tố. |
| ValidIntegerValuesValidator | "Số phải nằm trong khoảng hợp lệ [min, max]." |

**Yêu cầu thực hiện:**

- Cung cấp sơ đồ lớp UML minh họa thiết kế. Chỉ rõ quan hệ kế thừa (inheritance), quan hệ thành phần (composition), và các giao diện (interfaces) liên quan. Giải thích lựa chọn thiết nếu cần thiết.
- Cài đặt các phương thức chính, chẳng hạn như:
    + Cài đặt `IntegerRequestUseCase::nextPrime` (Chỉnh sửa lớp `IntegerRequestUseCase` nếu cần).
    + Cập nhật hàm `main` (Không cần viết lại toàn bộ hàm; chỉ cần mô tả những thay đổi cần thực hiện).

**D. Kết quả mong đợi từ các test cases**
1.  **Đầu vào rỗng** 
    ```text
    Please enter a prime number within the range of [1, 100]:
    Error: Invalid integer format
    ```
2.  **Định dạng đầu vào không hợp lệ**
    ```text
    Please enter a prime number within the range of [1, 100]: a15j
    Error: Invalid integer format
    ```
3.  **Giá trị ngoài phạm vi**
    ```text
    Please enter a prime number within the range of [1, 100]: 101
    Error: Value out of range
    ```
4.  **Không phải số nguyên tố**
    ```text
    Please enter a prime number within the range of [1, 100]: 15
    Error: Not a prime number
    ```
5.  **Dữ liệu đầu vào hợp lệ**
    ```text
    Please enter a prime number within the range of [1, 100]: 71
    You entered a prime: 71
    ```
<br> <div align="center">
    ---Hết---
</div>